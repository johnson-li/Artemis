/* Built on 2020-03-27 15:37:33 */
!function(){var e=function(e,t,n){var i=document.getElementById("header-"+(t.is_desktop?"desktop-":"mobile-")+e+"-toggle");i&&(t.opened=!1,t.menu=document.getElementById(t.id),t.menu_toggler=i,t.toggle=function(i){if(void 0===i||i!==t.opened){if(t.opened)xv.dom.addClass(t.menu,t.hide_class?t.hide_class:"mobile-hide"),t.body_cls_onopen&&xv.dom.removeClass(document.body,t.body_cls_onopen),xv.dom.removeClass(t.menu_toggler,t.icon_cls),"function"==typeof t.onclose_func&&t.onclose_func(t);else{window.xv.menus.closeAll(t.iAllMenuId);for(var s in n)s!==e&&n[s].toggle&&n[s].toggle(!1);xv.dom.removeClass(t.menu,t.hide_class?t.hide_class:"mobile-hide"),xv.dom.addClass(t.menu_toggler,t.icon_cls),t.body_cls_onopen&&xv.dom.addClass(document.body,t.body_cls_onopen),"function"==typeof t.onopen_func&&t.onopen_func(t),t.dontScrollToTop||xv.dom.scrollToTop()}t.opened=!t.opened}},t.iAllMenuId=window.xv.menus.addClose(function(){t.toggle(!1)}),window.xv.mobile.togglers.push(t),i.onclick=function(e){return e||(e=this.originalEvent),e&&("function"==typeof e.preventDefault?e.preventDefault():e.returnValue=!1),t.toggle(),!1})},t={togglers:new Array,menus_init:function(t){for(var n in t)e(n,t[n],t)}};window.xv||(window.xv={}),window.xv.mobile=t}(),function(){window.xv||(window.xv={});var e=function(e){this.sId=e.id,this.$Content=document.createElement("div"),this.setContent(e.c),this.sType=e.t,this.xMsgManager=e.xmm,this.fCallback="undefined"!=typeof e.cf&&e.cf,this.bHasCallbackFunc=!1!==this.fCallback,this.bClosable="string"==typeof e.ci,this.sReadId="string"==typeof e.ri?e.ri:"string"==typeof e.ci&&e.ci,this.sHash="string"==typeof e.h&&e.h,this.iCookieExpires="number"==typeof e.ce&&e.ce,this.iLastTimeInView=!1,this.bViewed="boolean"==typeof e.r&&e.r,this.bNotif="boolean"==typeof e.n&&e.n,this.bAdded=!1,this.bDeleted=!1,this.bIsPreview=!1,this.tPreviewEnd=!1,this.sLink="string"==typeof e.l&&e.l,this.sLinkTitle="string"==typeof e.lt&&e.lt,this.sImg="string"==typeof e.i&&e.i,this.sImgAlt="string"==typeof e.ia&&e.ia;var t=this;document.readyState&&"complete"===document.readyState?this.bHasCallbackFunc?this.setCallbackFunc():this.setTapReduce():xv.dom.addEventListener(window,"load",function(){t.bHasCallbackFunc?t.setCallbackFunc(e.cf):t.setTapReduce()}),!1!==this.iCookieExpires&&!1!==this.sHash&&this.xMsgManager.registerHash(this.sHash,this.iCookieExpires)};e.prototype={oIconClass:{success:"check-circle",error:"close-circle",warning:"warning-circle",question:"question-circle-o",info:"info-circle"},isAdded:function(){return this.bAdded},setAdded:function(e){"boolean"!=typeof e&&(e=!0),this.bAdded=e,this.isNotif()&&(this.bAdded?this.xMsgManager.addToAddedNotifIds(this.sId):this.xMsgManager.removeFromAddedNotifIds(this.sId))},isNotif:function(){return this.bNotif},getHash:function(){return this.sHash},hasBeenWatched:function(){if(this.isViewed())return!0;if(!this.isAdded())return!1;if(!xv.dom.isElementInView(this.getRender(),!0))return this.iLastTimeInView=!1,!1;if(this.iLastTimeInView>0){if(Date.now()-this.iLastTimeInView>1e3)return!0}else this.iLastTimeInView=Date.now();return!1},isViewed:function(){return this.bViewed},setViewed:function(e){"boolean"!=typeof e&&(e=!0),this.bViewed=e},isPreview:function(){return this.bIsPreview},setPreview:function(e,t){!1!==this.tPreviewEnd&&clearTimeout(this.tPreviewEnd),"boolean"!=typeof e&&(e=!0);var n=this,i=this.getRender(!1,!0);this.xMsgManager.isOpened()?this.removePreview():"function"==typeof $?e?($(i).stop().hide().slideDown(50),this.bIsPreview=!0):$(i).stop().slideUp("slow",function(){n.removePreview(),n.xMsgManager.hasPreview()||"boolean"==typeof t&&!1===t||n.xMsgManager.emptyPreviewContainer()}):(this.bIsPreview=e,this.bIsPreview||n.xMsgManager.hasPreview()||"boolean"==typeof t&&!1===t||n.xMsgManager.emptyPreviewContainer()),e?this.tPreviewEnd=setTimeout(function(){n.setAdded(!1),n.tPreviewEnd=!1,n.setPreview(!1)},3e3):n.xMsgManager.updateMsgContainer()},removePreview:function(){if(!this.isNotif())return!1;this.bIsPreview=!1;var e=this.getRender(!0,!0);if(!e)return!1;"function"==typeof $&&$(e).stop(!0,!0).show();var t=this.xMsgManager.getPreviewMsgContainer();if(e.parentNode!==t)return!1;t.removeChild(e)},isClosable:function(){return this.bClosable},setAsRead:function(){this.sReadId=!1},getReadId:function(){return this.sReadId||!1},isUnread:function(){return"string"==typeof this.sReadId},unDelete:function(){this.bDeleted=!1,this.xMsgManager.updateAllRenders()},"delete":function(e,t){this.bDeleted=!0;var n=this.getRender(!0),i=this;!1!==n&&n.parentNode&&("function"==typeof $&&!0!==t?$(n).animate({right:"-100%"},"fast",function(){$(n).slideUp("fast",function(){"function"==typeof e&&e(),$(n).remove(),i.xMsgManager.updateAllRenders()})}):(n.parentNode.removeChild(n),this.xMsgManager.updateAllRenders(),"function"==typeof e&&e())),this.setAdded(!1)},isDeleted:function(){return this.bDeleted},setContent:function(e){this.$Content.innerHTML=e},getRender:function(e,t){if("undefined"!=typeof this.$Render)return t||this.removePreview(),this.$Render;if(e)return!1;this.$Render=document.createElement("div"),this.$Render.className="x-message x-message-"+this.sType+(this.bHasCallbackFunc?" has-callback":"")+(this.isViewed()?"":" unviewed"),this.$Render.id=this.sId,this.$DivContent=document.createElement("div"),this.$DivContent.className="content",this.$Render.appendChild(this.$DivContent);var n;if("string"==typeof this.sLink&&this.sLink.length>0?(n=document.createElement("a"),n.setAttribute("href",this.sLink),"string"==typeof this.sLinkTitle&&this.sLinkTitle.length>0&&n.setAttribute("title",this.sLinkTitle),this.$DivContent.appendChild(n)):n=this.$DivContent,"string"==typeof this.sImg&&this.sImg.length>0){var i=document.createElement("img");i.setAttribute("src",this.sImg),i.setAttribute("alt","string"==typeof this.sImgAlt&&this.sImgAlt.length>0?this.sImgAlt:""),n.appendChild(i)}n.appendChild(this.$Content);var s=this.getIconClass();if("string"==typeof s){var o=document.createElement("span");o.className="bg-icon icon-f icf-"+s,this.$Render.appendChild(o)}var a=this.isClosable(),d=document.createElement("a"),r=document.createElement("span");d.className=a?"del":"reduce",d.setAttribute("href","#"),d.setAttribute("title",xv.utils.unescape(xv.i18n.__(a?"misc.delete":"misc.reduce"))),r.className="icon-f icf-"+(a?"close-thin":"angle-down"),d.appendChild(r);var l=this;return a?xv.dom.addEventListener(d,"click",function(){l.xMsgManager.delById(l.sId)}):xv.dom.addEventListener(d,"click",function(){l.xMsgManager.toggleOpening(!1)}),this.$Render.appendChild(d),this.$Render},updateRender:function(){var e=this.getRender(!0,!0);e&&(this.isViewed()?xv.dom.removeClass(e,"unviewed"):xv.dom.addClass(e,"unviewed"))},getDivContent:function(e,t){return!(!this.getRender(e,t)||!this.$DivContent)&&this.$DivContent},getIconClass:function(e){return void 0===e&&(e=this.sType),"undefined"!=typeof this.oIconClass[e]&&this.oIconClass[e]},setTapReduce:function(){var e=this.getRender(!1,!0);if(!1!==e){this.touch_started=!1;var t=this;return $(e).on("touchstart",function(){t.touch_started=Date.now()}),$(e).on("touchend",function(e){if(!t.touch_started)return!1;0===$(e.target).closest("a").length&&Date.now()-t.touch_started<100&&(e.preventDefault(),t.xMsgManager.toggleOpening(!1)),t.touch_started=!1}),!0}},setCallbackFunc:function(){var e=this.getDivContent();if(!1!==e){var t=this,n=this.getRender();this.bHasCallbackFunc?xv.dom.addClass(n,"has-callback"):xv.dom.removeClass(n,"has-callback"),xv.dom.addEventListener(e,"click",function(){t.execCallbackFunc()})}},execCallbackFunc:function(){var e;if("string"==typeof this.fCallback){if(aArgs=this.fCallback.split("."),0===aArgs.length)return this.fCallback=!1,void(this.bHasCallbackFunc=!1);e=window;for(var t in aArgs){var n=aArgs[t];if("object"!=typeof e[n]&&"function"!=typeof e[n])break;e=e[n]}}else e=this.fCallback=!1;this.fCallback="function"==typeof e&&e,this.bHasCallbackFunc=!1!==this.fCallback,this.bHasCallbackFunc?this.fCallback():this.xMsgManager.toggleOpening(!1)}};var t=function(){if(this.$Container=document.getElementById("page"),this.$Container||(this.$Container=document.body),!this.$Container)return!1;this.oMsgsById={},this.iMsgIdCount=0,this.bToggleBtnAdded=!1,this.bOpened=!1,this.bPartiallyOpened=!1,this.bNotificationsEnabled=!1,this.iVisibilityCheck=!1,this.aToggleCallbacks=[],this.oCookieExpiration={},this.aAddedNotifIds=[],this.aMsgsToDelete=[],this.bMessagesLoadedFromChat=!1,this.iNotifsNotLoaded=!1,this.iNotifsUnviewed=!1};t.prototype={initXMsg:function(t){if("string"==typeof t)t={c:t};else if("object"!=typeof t)return!1;var n=t.id;return"string"==typeof n&&0!==n.length||(this.iMsgIdCount++,t.id=n="msg-mngr-"+this.iMsgIdCount),t.xmm=this,this.oMsgsById[n]=new e(t),this.updateToggleBtn(),this.initUpdateViewedStatusCheck(),this.oMsgsById[n]},initXMsgs:function(e){for(var t=0;t<e.length;t++)this.initXMsg(e[t])},getById:function(e,t){var n=this.oMsgsById[e];return!(void 0===n||!0===n.isDeleted()&&!0!==t||!this.bNotificationsEnabled&&!0===n.isNotif()&&!0!==t)&&n},getAll:function(e){var t=[];for(var n in this.oMsgsById){var i=this.getById(n,e);i&&t.push(i)}return t},getAllSysMsg:function(e){var t=[];for(var n in this.oMsgsById){var i=this.getById(n,e);i&&!i.isNotif()&&t.push(i)}return t},getAllClosable:function(e){for(var t=this.getAll(e),n=[],i=0;i<t.length;i++){var s=t[i];s.isClosable()&&n.push(s)}return n},getAllClosableIds:function(e){for(var t=this.getAllClosable(e),n=[],i=0;i<t.length;i++){var s=t[i];n.push(s.sId)}return n},hasClosableMsg:function(e){for(var t=this.getAll(e),n=0;n<t.length;n++){if(t[n].isClosable())return!0}return!1},getByHash:function(e,t){var n=this.getAll(t);for(var i in n){var s=n[i];if(s.getHash()===e)return s}return!1},delById:function(e){this.delByIds([e])},delByIds:function(e,t){for(var n=[],i=0;i<e.length;i++){var s=this.getById(e[i]);s&&(s.isClosable()&&n.push(s),this.aMsgsToDelete.push(s))}var o=this;this.startDeletingMsgList(function(){o.saveAsRead(n),o.updateToggleBtn(),"function"==typeof t&&t()})},delAllClosable:function(e){this.delByIds(this.getAllClosableIds(),e)},startDeletingMsgList:function(e){if(0===this.aMsgsToDelete.length)return void("function"==typeof e&&e());var t=this;this.aMsgsToDelete.pop()["delete"](),setTimeout(function(){t.startDeletingMsgList(e)},40)},updateViewedStatus:function(){if(0===this.countUnviewed(!0))return this.clearUpdateViewedStatusCheck(),!1;var e=this.getAll(),t=[];for(var n in e)!e[n].isViewed()&&e[n].hasBeenWatched()&&t.push(e[n]);t.length>0&&(this.setAllToViewed(t),this.updateAllRenders())},initUpdateViewedStatusCheck:function(){this.clearUpdateViewedStatusCheck();var e=this;this.countUnviewed()>0&&(this.iVisibilityCheck=setInterval(function(){e.updateViewedStatus()},500))},clearUpdateViewedStatusCheck:function(){!1!==this.iVisibilityCheck&&(clearInterval(this.iVisibilityCheck),this.iVisibilityCheck=!1)},setAllToViewed:function(e){"object"!=typeof e&&(e=this.getAll());var t=[];for(var n in e)e[n].isViewed()||e[n].setViewed(),e[n].isUnread()||t.push(e[n]);this.saveAsRead(t)},saveAsRead:function(e){if(!(e.length<1)){var t="";for(var n in e)oMsg=e[n],oMsg.isUnread()&&(t+="msgid[]="+oMsg.getReadId()+"&",oMsg.setAsRead()),oMsg.setViewed(!0);if(""!==t){var i=xv.utils.createRequestObject();i.withCredentials=!0,i.open("POST","/account/message-closed",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(t)}}},showPreview:function(e){if(this.isOpened())return!1;var t=this.getById(e),n=this.getMsgContainer(),i=this.getPreviewMsgContainer();if(!t||!t.isNotif())return!1;xv.dom.addClass(n,"preview");var s=xv.dom.getChildren(i);s.length>0?i.insertBefore(t.getRender(!1,!0),s[0]):i.appendChild(t.getRender(!1,!0)),t.setPreview(!0)},hasPreview:function(){aMsgs=this.getAll();for(var e in aMsgs)if(aMsgs[e].isPreview())return!0;return!1},emptyPreviewContainer:function(){var e=this.getMsgContainer(),t=this.getAll();xv.dom.removeClass(e,"preview");for(var n in t)t[n].isPreview()&&t[n].removePreview();this.updateMsgContainer()},getLastAddedNotifMsg:function(){return 0!==this.aAddedNotifIds.length&&this.getById(this.aAddedNotifIds[0])},addToAddedNotifIds:function(e){this.removeFromAddedNotifIds(e),this.aAddedNotifIds.unshift(e)},removeFromAddedNotifIds:function(e){for(var t=0;t<this.aAddedNotifIds.length;t++)this.aAddedNotifIds[t]===e&&this.aAddedNotifIds.splice(t,1);return!1},count:function(e){if(!0!==e){var t=this.getAll().length;return isNaN(t)?0:t}var n=this.getAll(),i=0;for(var t in n)!0===n[t].isNotif()&&i++;return i},countTotal:function(){var e=this.count();return this.bNotificationsEnabled?"number"==typeof this.iNotifsNotLoaded&&(e+=this.iNotifsNotLoaded):e-=this.count(!0),e},countUnviewed:function(e){var t=this.getAll(),n=0,i=0;for(var s in t)!1===t[s].isViewed()&&(n++,!0===t[s].isNotif()&&i++);return this.bNotificationsEnabled?e||"number"!=typeof this.iNotifsUnviewed||(n+=this.iNotifsUnviewed-i):n-=i,n},createChatLoader:function(){var e=this.getById("message_spinner_from_chat",!0);if(e)return void(e.isDeleted()&&e.unDelete());this.initXMsg({id:"message_spinner_from_chat",c:'<span class="icon-f icf-spinner icf-anim-pulse"></span>',r:!0})},removeChatLoader:function(){var e=this.getById("message_spinner_from_chat");e&&e["delete"](!1,!0)},loadMessagesFromChat:function(){this.bMessagesLoadedFromChat||"function"==typeof window.xv.get_messages_from_chat&&(this.createChatLoader(),window.xv.get_messages_from_chat())},getToggleBtn:function(){return this.createToggleBtn(),this.$ToggleBtn},createToggleBtn:function(){if("undefined"==typeof this.$ToggleBtn){var e=document.createElement("button");e.id="x-x-messages-btn",e.setAttribute("type","button");var t=document.createElement("span");t.className="ic",e.appendChild(t);var n=document.createElement("span");n.className="icon-f icf-info-circle",n.setAttribute("title",xv.utils.unescape(xv.i18n.__("messages.from_site",{"%site%":1===xv.utils.getSiteId()?xv.conf.dyn.is_premium?"Xvideos RED":"Xvideos.com":xv.conf.dyn.is_premium?"XNXX GOLD":"XNXX.com"}))),t.appendChild(n),this.$ToggleBtnBadge=document.createElement("span"),this.$ToggleBtnBadge.className="badge",e.appendChild(this.$ToggleBtnBadge);var i=this;xv.dom.addEventListener(e,"click",function(){i.toggleOpening()}),this.$ToggleBtn=e}},addToggleBtn:function(){if(!0===this.bToggleBtnAdded)return!1;this.$Container.appendChild(this.getToggleBtn()),this.bToggleBtnAdded=!0},removeToggleBtn:function(){if(!0!==this.bToggleBtnAdded)return!1;this.bToggleBtnAdded=!1,this.toggleOpening(!1),this.$Container.removeChild(this.getToggleBtn())},updateToggleBtn:function(){var e=this.countTotal();if(0===e||isNaN(e))return void this.removeToggleBtn();this.addToggleBtn(),this.updateToggleBtnBadge(),this.isOpened()?xv.dom.addClass(this.getToggleBtn(),"opened"):xv.dom.removeClass(this.getToggleBtn(),"opened")},updateToggleBtnBadge:function(){if(!0!==this.bToggleBtnAdded)return!1;var e=this.countUnviewed();this.$ToggleBtnBadge.innerHTML=e,this.$ToggleBtnBadge.style.display=e>0?"inline-block":"none"},setNextToChat:function(){var e=this.getToggleBtn(),t=this.getMsgContainer(),n=this.getMsgMenu();xv.dom.addClass(e,"chat-window-side"),xv.dom.addClass(t,"chat-window-side"),xv.dom.addClass(n,"chat-window-side")},addToggleCallback:function(e){"function"==typeof e&&this.aToggleCallbacks.push(e)},isOpened:function(e){return this.bOpened&&(!0===e||!this.bPartiallyOpened||0===this.count(!0))},toggleOpening:function(e,t){if(this.emptyPreviewContainer(),"boolean"!=typeof e)e=!this.isOpened();else if(e===this.bOpened&&this.bPartiallyOpened===!!t)return;var n=this.getMsgContainer();this.bOpened=e;var i=this;if(this.bOpened)this.loadMessagesFromChat(),this.initUpdateViewedStatusCheck(),this.bPartiallyOpened=!!t,this.updateMsgContainer(),"function"==typeof $?$(n).slideDown("fast",function(){$(n).addClass("opened"),i.updateAllRenders()}):xv.dom.addClass(n,"opened");else{this.toggleSettings(!1),this.clearUpdateViewedStatusCheck();var s=[],o=0,a=Math.round((new Date).getTime()/1e3);for(var d in this.oCookieExpiration)s.push(d+":"+(a+parseInt(this.oCookieExpiration[d]))),o=Math.max(0,this.oCookieExpiration[d]);xv.cookies.setLocal("hide_xmsg",s.join(","),1e3*o,"/"),this.bPartiallyOpened?this.setAllToViewed(this.getAllSysMsg()):this.setAllToViewed(),"function"==typeof $?$(n).slideUp("fast",function(){$(n).removeClass("opened"),i.updateAllRenders()}):xv.dom.removeClass(n,"opened")}for(var r in this.aToggleCallbacks)this.aToggleCallbacks[r](this.bOpened);"function"!=typeof $&&this.updateAllRenders()},getMsgContainer:function(){return this.createMsgContainer(),this.$MsgContainer},getPreviewMsgContainer:function(){return this.createMsgContainer(),this.$PreviewMsgContainer},getSysMsgContainer:function(){return this.createMsgContainer(),this.$SysMsgContainer},getNotifMsgContainer:function(){return this.createMsgContainer(),this.$NotifMsgContainer},createMsgContainer:function(){if("undefined"==typeof this.$MsgContainer){this.$MsgContainer=document.createElement("div"),this.$MsgContainer.id="x-messages",this.$MsgContainerScrollable=document.createElement("div"),this.$MsgContainerScrollable.id="x-messages-scrollable",this.$PreviewMsgContainer=document.createElement("div"),this.$PreviewMsgContainer.className="preview-container";var e=this,t=document.createElement("div");t.className="preview-overlay",xv.dom.addEventListener(t,"click",function(){e.toggleOpening(!0)}),this.$PreviewMsgContainer.appendChild(t),this.$MsgContainerScrollable.appendChild(this.$PreviewMsgContainer),this.$SysMsgContainer=document.createElement("div"),this.$MsgContainerScrollable.appendChild(this.$SysMsgContainer),this.$NotifMsgContainer=document.createElement("div"),$NotifTitle=document.createElement("p"),$NotifTitleIcon=document.createElement("span"),$NotifTitle.className="notif-sep",$NotifTitleIcon.className="icon-f icf-bell",$NotifTitle.appendChild($NotifTitleIcon),this.$NotifMsgContainer.appendChild($NotifTitle),this.$MsgContainerScrollable.appendChild(this.$NotifMsgContainer),this.$MsgContainer.appendChild(this.$MsgContainerScrollable);var n=this.getToggleBtn();this.addToggleBtn(),n.parentNode.insertBefore(this.$MsgContainer,n),xv.dom.addEventListener(this.$MsgContainerScrollable,"scroll",function(){e.updateMsgContainerScroll()}),this.updateToggleBtn()}},updateMsgContainer:function(){var e=this.getSysMsgContainer(),t=this.getNotifMsgContainer();if(!this.isOpened(!0))return xv.dom.addClass(e,"hidden"),void xv.dom.addClass(t,"hidden");xv.dom.removeClass(e,"hidden");var n=this;setTimeout(function(){n.updateMsgContainerScroll()},200);var i=this.getPreviewMsgContainer(),s=this.getAll();0!==this.count(!0)&&!this.bPartiallyOpened&&this.isOpened()&&this.bNotificationsEnabled?xv.dom.removeClass(t,"hidden"):xv.dom.addClass(t,"hidden"),this.bNotificationsEnabled?xv.dom.removeClass(i,"hidden"):xv.dom.addClass(i,"hidden");for(var o in s){var a=s[o];if(a.isAdded())a.updateRender();else if(a.isNotif()){if(!this.bPartiallyOpened){var d=this.getLastAddedNotifMsg(),r=a.getRender();d?t.insertBefore(r,d.getRender()):t.appendChild(r),a.setAdded()}}else e.appendChild(a.getRender()),a.setAdded()}},updateMsgContainerScroll:function(){var e=this.getMsgContainer();if(!isNaN(this.$MsgContainerScrollable.scrollHeight)){if(this.$MsgContainerScrollable.scrollHeight<=this.$MsgContainerScrollable.offsetHeight)return xv.dom.removeClass(e,"can-scroll-top"),void xv.dom.removeClass(e,"can-scroll-bottom");if(0===this.$MsgContainerScrollable.scrollTop)return xv.dom.removeClass(e,"can-scroll-top"),void xv.dom.addClass(e,"can-scroll-bottom");xv.dom.addClass(e,"can-scroll-top"),this.$MsgContainerScrollable.offsetHeight+this.$MsgContainerScrollable.scrollTop>=this.$MsgContainerScrollable.scrollHeight?xv.dom.removeClass(e,"can-scroll-bottom"):xv.dom.addClass(e,"can-scroll-bottom")}},getMsgMenu:function(){return this.createMsgMenu(),this.$MsgMenu},createMsgMenu:function(){if("undefined"==typeof this.$MsgMenu){this.$MsgMenu=document.createElement("div"),this.$MsgMenu.id="x-messages-menu";var e=this,t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("title",xv.utils.unescape(xv.i18n.__("misc.reduce")));var n=document.createElement("span");n.className="icon-f icf-angle-down",t.appendChild(n),xv.dom.addEventListener(t,"click",function(){e.toggleOpening(!1)});var i=document.createElement("button");i.className="remove-btn",i.setAttribute("type","button"),i.setAttribute("title",xv.utils.unescape(xv.i18n.__("messages.short.delete_all")));var s=document.createElement("span");s.className="icon-f icf-trash",i.appendChild(s);var o=document.createElement("span");o.className="mobile-hide",o.innerHTML=xv.utils.unescape(xv.i18n.__("messages.short.delete_all")),i.appendChild(o);var a=document.createElement("span");a.className="mobile-show",a.innerHTML=xv.utils.unescape(xv.i18n.__("messages.shorter.delete_all")),i.appendChild(a),xv.dom.addEventListener(i,"click",function(){e.delAllClosable(function(){e.toggleOpening(!1)})}),this.$SettingsBtn=document.createElement("button"),this.$SettingsBtn.className="settings-btn",this.$SettingsBtn.setAttribute("type","button"),this.$SettingsBtn.setAttribute("title",xv.utils.unescape(xv.i18n.__("misc.settings")));var d=document.createElement("span");d.className="icon-f icf-cog",this.$SettingsBtn.appendChild(d),xv.dom.addEventListener(this.$SettingsBtn,"click",function(){e.toggleSettings()}),this.$MsgMenu.appendChild(this.$SettingsBtn),this.$MsgMenu.appendChild(i),this.$MsgMenu.appendChild(t);var r=this.getToggleBtn();this.addToggleBtn(),r.parentNode.insertBefore(this.$MsgMenu,r),this.updateToggleBtn()}},updateMsgMenu:function(){var e=this.getMsgMenu();return this.isOpened(!0)?("function"==typeof $?$(e).hasClass("opened")||$(e).slideDown("fast",function(){$(e).addClass("opened")}):xv.dom.addClass(e,"opened"),this.hasMsgMenuSetting()?xv.dom.addClass(e,"has-settings"):xv.dom.removeClass(e,"has-settings"),this.isOpened()?(xv.dom.removeClass(e,"partially"),void(this.hasClosableMsg()?xv.dom.addClass(e,"has-closable"):xv.dom.removeClass(e,"has-closable"))):(xv.dom.removeClass(e,"has-closable"),void xv.dom.addClass(e,"partially"))):("function"==typeof $?$(e).slideUp("fast",function(){$(e).removeClass("opened")}):xv.dom.removeClass(e,"opened"),void this.toggleSettings(!1))},toggleSettings:function(e){if("boolean"!=typeof e)e=!this.bSettingsOpened;else if(e===this.bSettingsOpened)return;this.bSettingsOpened=e;var t=this.getSettings();this.bSettingsOpened?("function"==typeof $?$(t).slideDown("fast",function(){$(t).addClass("opened")}):xv.dom.addClass(t,"opened"),xv.dom.addClass(this.$SettingsBtn,"opened")):(xv.dom.removeClass(t,"opened"),"function"==typeof $?$(t).slideUp("fast",function(){$(t).removeClass("opened")}):xv.dom.removeClass(t,"opened"),xv.dom.removeClass(this.$SettingsBtn,"opened"))},getSettings:function(){return this.updateSettings(),this.$Settings},updateSettings:function(){if(this.createSettings(),"undefined"!=typeof this.aSettings&&("undefined"==typeof this.iLastSettingsUpdate||this.iLastSettingsUpdate!==this.aSettings.length)){this.iLastSettingsUpdate=this.aSettings.length;for(var e=0;e<this.aSettings.length;e++){var t=this.aSettings[e];if(!t.bAdded){t.bAdded=!0;var n=document.createElement("button");n.className="btn btn-default",n.setAttribute("type","button"),n.innerHTML=t.sTitle,xv.dom.addEventListener(n,"click",t.fAction),this.$Settings.appendChild(n)}}}},createSettings:function(){if("undefined"==typeof this.$Settings){this.$Settings=document.createElement("div"),this.$Settings.id="x-messages-menu-settings";var e=this,t=document.createElement("button");t.className="close",t.setAttribute("type","button");var n=document.createElement("span");n.className="icon-f icf-close-thin",t.appendChild(n),xv.dom.addEventListener(t,"click",function(){e.toggleSettings(!1)}),this.$Settings.appendChild(t);var i=document.createElement("p");i.className="title";var s=document.createElement("span");s.className="icon-f icf-cog",i.appendChild(s);var o=document.createTextNode(" "+xv.utils.unescape(xv.i18n.__("misc.settings"))+" ");i.appendChild(o),this.$Settings.appendChild(i);var a=this.getToggleBtn();this.addToggleBtn(),a.parentNode.insertBefore(this.$Settings,a),this.updateToggleBtn()}},addAMsgMenuSetting:function(e,t){"undefined"==typeof this.aSettings&&(this.aSettings=[]),this.aSettings.push({sTitle:e,fAction:t,bAdded:!1})},hasMsgMenuSetting:function(){return"undefined"!=typeof this.aSettings&&this.aSettings.length>0},registerHash:function(e,t){this.oCookieExpiration[e]=t||1296e3},updateAllRenders:function(){this.updateToggleBtn(),this.updateMsgContainer(),this.updateMsgMenu()},setNotificationFeatureEnabled:function(e){this.bNotificationsEnabled=!!e,this.updateAllRenders()}},xmm=new t;var n=function(e){this.$Msg=e;var t=xv.dom.getChildren(this.$Msg),n=this;for(var i in t){var s=t[i];if(xv.dom.hasClass(s,"del")){var o;if(!(o=s.dataset?s.dataset.id:s.getAttribute("id")))return void s.parentNode.removeChild(s);this.sCloseId=o,xv.dom.addEventListener(s,"click",function(e){e=e||window.event,"function"==typeof e.preventDefault?e.preventDefault():e.returnValue=!1,n["delete"]()})}}};n.prototype={"delete":function(){var e=xv.utils.createRequestObject();e.withCredentials=!0,e.open("POST","/account/message-closed",!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send("msgid[]="+this.sCloseId),this.$Msg.parentNode.removeChild(this.$Msg)}};var i=function(e){this.$Container=e,this.$ContainerInner=xv.dom.getFirstChild(this.$Container);var t=xv.dom.getChildren(this.$ContainerInner);for(var i in t){var s=t[i];xv.dom.hasClass(s,"x-message")&&new n(s)}},s=document.getElementById("x-home-messages");s&&new i(s);var o=document.getElementById("x-red-home-messages");o&&new i(o),window.xv.messages={registerOnToggle:function(e){xmm&&"function"==typeof xmm.addToggleCallback&&xmm.addToggleCallback(e)},xmmDelById:function(e){xmm&&"function"==typeof xmm.delById&&xmm.delById(e)},updateAjaxTabMessages:function(){var e=document.getElementById("x-ajax-tab-messages");e&&new i(e)},addXMessageSetting:function(e,t){if(!xmm)return!1;xmm.addAMsgMenuSetting(e,t)},setMessageNextToChat:function(){xmm&&xmm.setNextToChat()},removeChatLoader:function(){if(!xmm)return!1;xmm.removeChatLoader()},setNotificationFeatureEnabled:function(e){if(!xmm)return!1;xmm.setNotificationFeatureEnabled(e)},addMessageFromChat:function(e,t){if("object"!=typeof e||"object"!=typeof xmm||"function"!=typeof xmm.initXMsg)return!1;e.n=!0;var n=xmm.initXMsg(e);xmm.updateAllRenders(),!xmm.isOpened()&&n&&(t?xmm.toggleOpening(!0):xmm.showPreview(n.sId))},setMessagesFromChat:function(e){if(!xmm)return!1;if(xmm.removeChatLoader(),"object"==typeof e)for(var t in e){var n=!1;if("string"==typeof e[t].h){var i=xmm.getByHash(e[t].h);"object"==typeof i&&"function"==typeof i.setContent&&(i.setContent(e[t].c),i.setAdded(!1),n=!0)}!1===n&&xmm.initXMsg(e[t])}xmm.bMessagesLoadedFromChat=!0,xmm.updateAllRenders()},setMessagesCountsFromChat:function(e){if("undefined"==typeof e.count||"undefined"==typeof e.count_unread||!xmm||"undefined"!=typeof xmm&&xmm.bMessagesLoadedFromChat)return!1;isNaN(parseInt(e.count))||(xmm.iNotifsNotLoaded=parseInt(e.count)),isNaN(parseInt(e.count_unread))||(xmm.iNotifsUnviewed=parseInt(e.count_unread)),xmm.updateToggleBtn(),xmm.isOpened()&&xmm.loadMessagesFromChat()}},xv.conf&&"undefined"!=typeof xv.conf.dyn.xmsg&&xv.conf.dyn.xmsg.length>0&&(xmm.initXMsgs(xv.conf.dyn.xmsg),xmm.toggleOpening(!0,!0))}(),function(){var e={};if(e.menu={id:"mobile-menu",icon_cls:"vertical"},e.filters={id:"mobile-filters-menu",icon_cls:"opened"},e.search={id:"xv-search-form",icon_cls:"close",dontScrollToTop:!0,onopen_func:function(){if(window.jQuery){$("#xv-search-form input[type=text]").first().focus();var e=$("#xv-search-form").offset().top;if($(window).width()>$(window).height()&&$(window).scrollTop()<e)return $("html,body").animate({scrollTop:e},400),!1}xv.dom.scrollToTop()}},xv.mobile.menus_init(e),xv.header&&(xv.header.nav=document.getElementById("nav"),xv.header.nav_trends=document.getElementById("nav-trends"),xv.header.nav)){xv.header.nav_var={menu_toggle:document.getElementById("header-menu-toggle"),is_opened_desktop:xv.dom.hasClass(xv.header.nav,"forced-opened"),main_gender_cats_btn:document.getElementById("main-cat-switch-a"),main_cat_btn:document.getElementById("main-cat-sub-list-btn"),home_trends_btn:document.getElementById("home-trends-sub-list-btn"),video_history_btn:document.getElementById("video-history-sub-list-btn")};var t,n={},i=[],s=!1,o=!1,a=0,d=-1,r=function(){for(var e in n)l(e)},l=function(e){!1===n[e].initiated&&(n[e].initiated="processing",n[e].list&&n[e].btn?xv.dom.addEventListener(n[e].btn,"click",function(){f(e)}):n[e].disabled=!0,n[e].initiated=!0)},h=function(){if(!0===s)return!1;s=!0;for(var e=0;e<i.length;e++){var t=i[e];"function"==typeof t&&t()}i=[]},c=function(e){if(xv.header.is_mobile_menu(!1)){t=!1;for(var i in n)n[i].is_opened=!1}else!0!==e&&g(!1);xv.header.update_menu_classs()},u=function(e){if(xv.header.is_mobile_menu(!1)&&"desktop"!==e){h(),t=!0,xv.menus.closeAll(d);var i=!0;for(var s in n)!0===n[s].is_opened&&(i=!1);!0===i&&(n[o].is_opened=!0)}else g(!0);"undefined"!=typeof xv.header&&"undefined"!=typeof xv.header.trends&&"function"==typeof xv.header.trends.position&&xv.header.trends.position(),xv.header.update_menu_classs()},g=function(e){e=!!e,xv.conf&&xv.conf.dyn&&xv.conf.dyn.menu_state_save_id&&(e?xv.cookies.setLocal(xv.conf.dyn.menu_state_save_id,"opened",5e3,"/"):xv.cookies.setLocal(xv.conf.dyn.menu_state_save_id,"closed",2592e6,"/")),xv.header.nav_var.is_opened_desktop=e},f=function(e){if(n[e].is_opened)return xv.header.update_menu_classs(),void("function"==typeof n[e].already_opened_func&&n[e].already_opened_func());for(var t in n)n[t].is_opened=!1;n[e].is_opened=!0,xv.header.update_menu_classs()};xv.header.add_sub_menu=function(e,t,i,s,d,l){if(e&&t){var h={btn:e,list:t,is_opened:!1,disabled:!1,initiated:!1};return a++,"string"!=typeof i&&(i="sub_menu_"+a),l&&"function"==typeof l.already_opened_func&&(h.already_opened_func=l.already_opened_func),n[i]=h,!1!==o&&!0!==d||(o=i),!0!==s&&r(),i}},xv.header.add_mobile_menu_init=function(e){s=!1,i.push(e),t&&xv.header.is_mobile_menu(!1)&&h()},xv.header.is_menu_opened=function(){return window_resize_callback(!1),!xv.header.is_mobile_menu(!1)&&xv.header.nav_var.is_opened_desktop||xv.header.is_mobile_menu(!1)&&t},xv.header.is_sub_menu_opened=function(e){return!(!xv.header.is_menu_opened()||"undefined"==typeof n[e]||!n[e].is_opened)},xv.header.open_sub_menu=function(e){if(!xv.header.is_mobile_menu(!1))return!1;if(!e){if(!o)return!1;e=o}u("mobile"),f(e),"undefined"!=typeof window.xv&&"undefined"!=typeof window.xv.dom&&"function"==typeof window.xv.dom.scrollToTop&&window.xv.dom.scrollToTop()},xv.header.open_default_sub_menu=function(){xv.header.open_sub_menu()},xv.header.update_menu_classs=function(){if(window.jQuery)if(xv.header.is_mobile_menu(!1)){var e=$(".home-trends #home-trends-sub-list-btn");e.length>0&&e.parent("li").insertAfter($("#main-cat-sub-list-btn").parent("li"))}else{var e=$(".main-categories #home-trends-sub-list-btn");e.length>0&&$(".home-trends > ul").prepend(e.parent("li"))}xv.header.is_menu_opened()?(xv.dom.addClass(xv.header.nav,"opened"),xv.header.nav_trends&&xv.dom.addClass(xv.header.nav_trends,"opened"),xv.dom.addClass(xv.header.nav_var.menu_toggle,"opened"),xv.header.is_mobile_menu(!1)||"undefined"==typeof xv||"undefined"==typeof xv.header?xv.dom.addClass(document.body,"mobile-menu-opened"):("undefined"!=typeof xv.header.categories&&"function"==typeof xv.header.categories.position&&setTimeout(xv.header.categories.position,150),"undefined"!=typeof xv.header.trends&&"function"==typeof xv.header.trends.position&&setTimeout(xv.header.trends.position,150))):(xv.dom.removeClass(xv.header.nav,"opened forced-opened"),xv.header.nav_trends&&xv.dom.removeClass(xv.header.nav_trends,"opened forced-opened"),
xv.dom.removeClass(xv.header.nav_var.menu_toggle,"opened"),xv.dom.removeClass(document.body,"mobile-menu-opened"));for(var t in n)!0!==n[t].disabled&&(n[t].is_opened?(xv.dom.addClass(n[t].btn,"opened"),xv.dom.addClass(n[t].list,"opened")):(xv.dom.removeClass(n[t].btn,"opened"),xv.dom.removeClass(n[t].list,"opened")))},xv.header.update_sub_menu_btn=function(e,t){"undefined"!=typeof n[e]&&t&&(n[e].btn=t,xv.dom.addEventListener(n[e].btn,"click",function(){f(e)}))},xv.header.update_sub_menu_list=function(e,t){"undefined"!=typeof n[e]&&t&&(n[e].list=t)},xv.header.nav_var.main_cat_btn&&xv.header.add_sub_menu(xv.header.nav_var.main_cat_btn,document.getElementById("main-cat-sub-list"),"main_cat",!0),xv.header.nav_var.home_trends_btn&&xv.header.add_sub_menu(xv.header.nav_var.home_trends_btn,document.getElementById("home-trends-sub-list"),"home_trends",!0),xv.header.nav_var.main_gender_cats_btn&&(xv.header.add_sub_menu(xv.header.nav_var.main_gender_cats_btn,document.getElementById("nav-main-cat-switcher-list"),"main_gender_cats",!0),xv.dom.addClass(xv.header.nav_var.main_gender_cats_btn,"init-ok")),xv.header.nav_var.video_history_btn&&xv.header.add_sub_menu(xv.header.nav_var.video_history_btn,document.getElementById("video-history"),"video_history",!0),r(),xv.header.update_menu_classs(),window_resize_callback(),xv.dom.addEventListener(window,"resize",xv.header.window_resize),xv.dom.addEventListener(xv.header.nav_var.menu_toggle,"click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,(xv.header.is_mobile_menu(!1)?t:xv.header.nav_var.is_opened_desktop)?c():u()}),xv.dom.addClass(xv.header.nav_var.menu_toggle,"init-ok"),d=xv.menus.addClose(function(){c(!0)})}}();