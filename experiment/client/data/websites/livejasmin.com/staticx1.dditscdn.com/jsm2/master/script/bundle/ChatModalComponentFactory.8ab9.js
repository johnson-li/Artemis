(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{6741:function(e,t,i){var s=i("3414"),a=i("d869"),n=i("83cb"),o=function(e){o.superclass.constructor.call(this,e)};e.exports=Ext.extend(o,n,{name:a.FlashChatPageControllerAbstract.NAME,chatId:"chatapplet",minAppletHeight:1,minAppletWidth:1,defaultBrowserScrollBarWidth:17,removeAppletCounter:10,chatCounter:0,chatPageId:a.PageId.CHAT_PERFORMER,cookieExpiration:2592e3,defaultAppletResizeTimeOut:5e3,isVideoContentOpened:!1,_isFirstPerfShown:!1,_memberApplet:{},flashVarsNeedRefresh:["performerid","pid","sbip","sbhash","proxyip","category","tags","lowcamfeed","ishd","ishq","isFavorite","teaserduration","teaseraudio","teaserurl","teaservideoaudio","teasertype","channel_type"],init:function(e,t){this.addEvents(a.FlashChatPageControllerAbstract.EVENT_OVERLAY_CONTENT_READY,a.FlashChatPageControllerAbstract.EVENT_MODEL_CHANGE,a.FlashChatPageControllerAbstract.EVENT_APPLET_RESIZE,a.FlashChatPageControllerAbstract.EVENT_WINDOW_RESIZE),o.superclass.init.call(this,e,t),this.getAppletContainer()},getAppletContainer:function(){},muteChatApplet:function(){this.isVideoContentOpened=!0,this.callFunctionOnApplet("videoPlayingStarted")},unMuteChatApplet:function(){this.isVideoContentOpened&&(this.isVideoContentOpened=!1,this.callFunctionOnApplet("videoPlayingStopped"))},callFunctionOnApplet:function(e){var t=this.getAppletContainer();t&&s.isFunction(t[e])&&setTimeout((function(){try{t[e]()}catch(e){console.log(e)}}),0)},setSessionId:function(e){try{this.getAppletContainer().setSessionId(e)}catch(e){console.error("Set session id failed: ",e)}},setLayoutMode:function(e){var t=s.Config.get("memberAppletFlashvars");t.appletsize=e,s.Config.set("memberAppletFlashvars",t),this._memberApplet.flashvars=t,this.model.setLayoutMode(e)},resetChatApplet:function(){},setDefaultFlashVars:function(){s.each(this.flashVarsNeedRefresh,(function(e,t){this.setAllAppletsFlashvars(this.flashVarsNeedRefresh[t],"")}),this)},_refreshFlashVars:function(e){var t=this._decodeFlashVars(e);for(var i in this.setDefaultFlashVars(),t)if(t.hasOwnProperty(i)){var s=i.replace("_","");this.setAllAppletsFlashvars(s,t[i])}},_decodeFlashVars:function(e){return Ext.isObject(e)?e:Ext.decode(e)},setAllAppletsFlashvars:function(e,t){this._memberApplet.flashvars&&(this._memberApplet.flashvars[e]=t)},getAppletFlashvars:function(){return this._memberApplet.flashvars},onWindowResize:function(){this.fireEvent(a.FlashChatPageControllerAbstract.EVENT_WINDOW_RESIZE)},onAppletLayoutModeChange:function(e){this.model.isPrivateEndDisplayed()||this.setLayoutMode(e.layout)},onBeforeUnload:function(){this.callHideChatOnMemberApplet()},callHideChatOnMemberApplet:function(){var e=this.getAppletContainer();e&&s.isFunction(e.hideChat)&&e.hideChat()},onExitFullScreen:function(){this.setLayoutMode(a.FlashChatPageControllerAbstract.LAYOUT_MODE_FULL)},onUpdateScrollPosition:function(e){this.view.updateScrollPosition(e)},setPerformerDetailsOnApplet:function(){},backToPrivate:function(){this.callFunctionOnApplet("backToPrivate")},onPerformerDetailsReady:function(e){var t=s.getPath(e,"json.data");this._performerName=t.performer_id||t.performerid,o.superclass.onPerformerDetailsReady.call(this,e)},bind:function(){o.superclass.bind.call(this),s.on([{element:Ext.fly(window),event:"beforeunload",handler:this.onBeforeUnload},{element:s.Broadcaster,event:a.BasicController.GLOBALEVENT_REFRESH_APPLET_SESSION,handler:this.setSessionId}],this)}})},"83cb":function(e,t,i){var s=i("3414"),a=i("d869"),n=i("e5b0").default,o=function(e,t){o.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(o,s.Controller,{name:"ChatPageControllerAbstract",init:function(e,t){var i;o.superclass.init.call(this,e,t),this._isFirstPerfShown=this.model.isChatPage,i=this._getNormalizeAppletVars(),this._saveToHistory(i)},onPrivateStartClick:function(){this.model.setIsOnPrivate(!0)},onPrivateEnd:function(){this.model.setIsOnPrivate(!1)},registerHistory:function(){this.nextPerformerHistoryEntry="next-performer",s.History.registerActions(this.nextPerformerHistoryEntry,this.nextPerformerHistoryEntry,this.setNextModel,this),s.History.registerComponent(this,{state:this.nextPerformerHistoryEntry}),this.replaceState()},_saveToHistory:function(e){var t=e.p_id||e.pid;if(t){var i=e.performer_id||e.performerid,n=e.display_name,o=e.status;s.Broadcaster.fireEvent(a.PerformerHistory.ADD_PERFORMER_TO_HISTORY,{name:i,displayName:n,id:t.toString(),status:o})}},_getNormalizeAppletVars:function(){return s.Config.get("memberAppletFlashvars")?s.Config.get("memberAppletFlashvars"):s.Config.get("HTMLAppletVars")},replaceState:function(){throw"This method must be implemented."},setNextModel:function(e){if(!s.Config.get("isOnPrivate")){var t={performerId:e.name};this.model.getCurrentPerformerName()!==e.name&&(this.onGetPerformerDetails(t,!0),this.fireEvent(a.ChatPageController.HISTORY_CHANGE,e.name))}},getModelData:function(e){var t={};return"string"==typeof e?(t.performerId=e,t):e},onGetPerformerDetails:function(e){var t=this.getModelData(e),i=t.performerId;s.Config.set("performerChannelType",t.channelType),this._callPerformerDetailsService(i),this.model.setCurrentPerformerName(i);var n=this._getNormalizeAppletVars();this.fireEvent(a.ChatPageControllerAbstract.EVENT_MODEL_CHANGE,{modelData:t,flashVars:n,isFirstPerfShown:this._isFirstPerfShown}),this._isFirstPerfShown=!0},_callPerformerDetailsService:function(e){n.get(e).then(s.bind(this.onPerformerDetailsReady,this)).catch((function(e){}))},onPerformerDetailsReady:function(e){var t=s.getPath(e,"json.data");this._performerData=e.responseText,this._refreshFlashVars(t),this._saveToHistory(t),this.setPerformerDetailsOnApplet()},_refreshFlashVars:function(e){s.Config.set("memberAppletFlashvars",e)},setPerformerDetailsOnApplet:function(){throw"You must implement setPerformerDetailsOnApplet method"}})},a290:function(e,t,i){"use strict";i.r(t);var s=i("3414"),a=i.n(s),n=i("7ab0"),o=i.n(n),r=i("d869"),l=i.n(r),h=i("0592"),c=i("2daa"),d=i.n(c),p=i("6741"),m=i.n(p);function u(e,t,i,s,a,n,o){try{var r=e[n](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(s,a)}var f=function e(t){e.superclass.constructor.call(this,t)};Ext.extend(f,m.a,{name:l.a.ChatPageModalControllerAbstract.NAME,chatTopValue:0,init:function(e,t){t.items.model.component.isChatPage=!1,t.items.model.component.setIsMinimized(!0),f.superclass.init.call(this,e,t)},onGetPerformerDetails:function(){f.superclass.onGetPerformerDetails.apply(this,arguments);var e=this.model.getCurrentPerformerName();this.model.getIsMinimized()||d.a.getHash()==="chat/".concat(e)||h.default.navigateToChatPage("chat/".concat(e),{trigger:!1,keepActiveModal:!0,preventNavigateBack:!0})},onPerformerDetailsReady:function(e){this._performerData=e.responseText,this.model.getIsMinimized()||this.loadAppletAndPlay(),f.superclass.onPerformerDetailsReady.call(this,e)},openChatModal:function(e){this.model.getIsLocked()?this.unlockChatModal():this.showChatModal(e)},redirectToDisplayName:function(e,t){e===t||this.model.getIsMinimized()||h.default.navigateToChatPage("chat/".concat(t),{trigger:!0,replace:!0,preventNavigateBack:!0})},showChatModal:function(e){var t,s=this;return(t=regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(i.bind(null,"f94d"));case 2:(a=t.sent).default.instance.onDetailsReadyCallback=function(t){var i=t.display_name;s.redirectToDisplayName(e,i)},a.default.instance.playStreamByPerformerName(e).catch((function(){})),s.view.showChat(),s.model.setIsMinimized(!1);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(s,a){var n=t.apply(e,i);function o(e){u(n,s,a,o,r,"next",e)}function r(e){u(n,s,a,o,r,"throw",e)}o(void 0)}))})()},redirectOnPerformerError:function(){var e=a.a.getUrl("Error/Error404");setTimeout((function(){document.location.replace(e)}),1e3)},showChatBlock:function(){this.view._showChatBlock()},unlockChatModal:function(){this.model.setIsLocked(!1),this.view.unlockChat()},lockChatModal:function(){this.model.setIsLocked(!0),this.view.lockChat()},closeChatModal:function(){this.model.getIsOnPrivate()||(this.model.setIsLocked(!1),this.model.setIsMinimized(!0),this.view.hideChat(),this.resetChatApplet())},closeApplet:function(){this.model.getIsMinimized()||this.model.getIsLocked()||this.model.isPrivateEndDisplayed()||(this.model.setIsMinimized(!0),this.view.hideChat(),h.default.navigate("/",{trigger:!0,preventNavigateBack:!0}))},onModalOpened:function(e){e.scope&&e.scope.name===l.a.ChatModalComponent.NAME&&!this.model.isPrivateEndDisplayed()&&this.showChatBlock()},loadAppletAndPlay:function(){throw"You must implement loadAppletAndPlay method"},_setSessionFlashVars:function(){this.getAppletFlashvars()&&(this.setAllAppletsFlashvars("sessionid",a.a.Config.get("sessionIdJasmin1")),this.setAllAppletsFlashvars("jsm2session",o.a.getSessionId()),this.setAllAppletsFlashvars("issearchpage",parseInt(a.a.getMeta("isSearchPage"))))}}),t.default=f},a937:function(e,t,i){var s=i("3414"),a=i("d869"),n=i("a290").default,o=i("0592").default,r=i("a9a1").store,l=i("c33b").startPrivate,h=i("7ab0"),c=i("1cab").GA_CONST,d=function(e){d.superclass.constructor.call(this,e)};e.exports=Ext.extend(d,n,{name:a.HTML5ChatPageModalController.NAME,init:function(e,t){d.superclass.init.call(this,e,t),s.Config.set("OverlayAppletType",a.appletType.HTML5),this.startVideoCallParams={}},openChatModal:function(e){d.superclass.openChatModal.call(this,e),this.model.isPrivateEndDisplayed()||(this.html5Client.sizeChange(),this.view.showHTML5Applet(),this.view.setAppletSizeType())},showChatModal:function(e){var t=s.Config.get("HTMLAppletVars");if(t){var i=t.performer_id||t.performerid,n=t.display_name;i===e&&s.Broadcaster.fireEvent(a.PerformerHistory.ADD_PERFORMER_TO_HISTORY,{name:i,displayName:n,id:(t.p_id||t.pid).toString(),status:t.status})}d.superclass.showChatModal.call(this,e);try{this.html5Client.sizeChange(),this.html5Client.enableKeyboard()}catch(e){}this.showChatBlock()},getAppletContainer:function(){return this.html5Client},onLogIn:function(e){this._setSessionIdOnApplet(e)},onSignupSuccess:function(e){this._setSessionIdOnApplet(e)},_setSessionIdOnApplet:function(e){var t=e.json.data,i={sessionid:t.jsm1sessionid,jsm2sessionid:t.jsm2sessionid};try{this.html5Client.setSessionId(i)}catch(e){console.error(e)}},resetChatApplet:function(){this.html5Client.hideChat()},loadAppletAndPlay:function(){this._setSessionFlashVars(),this.html5Client.performerDetailsReady(this._performerData)},onModalOpened:function(e){d.superclass.onModalOpened.call(this,e),this.toggleKeyboardActionsOnApplet(e,!1)},onModalClosed:function(e){this.toggleKeyboardActionsOnApplet(e,!0)},onPrivatePeekButtonClick:function(){this.html5Client.startSneakPeek()},onJoinVipShowFromListPageClick:function(){this.html5Client.joinVIPShow()},onVideoCallButtonClick:function(){var e=h.isCurrentPage(a.PageId.FAVORITE_INDEX)?c.PAGE.FAVORITE:c.PAGE.LISTS;this.html5Client.startVideoCall(e)},onStartVideoCallFromMessenger:function(e){this.onStartVideoCall(e,c.PAGE.MESSAGES)},onStartVideoCall:function(e,t){this.startVideoCallParams={modelName:e,location:t},o.navigateToChatPage("chat/"+e,{trigger:!0,preventNavigateBack:!0})},onStartPrivate:function(e){this.performerToPrivateFromMessages=e,o.navigateToChatPage("chat/"+e,{trigger:!0,preventNavigateBack:!0})},onStreamReady:function(){var e=this.startVideoCallParams.modelName,t=this.startVideoCallParams.location;if(e===r.getState().performer.nick){this.startVideoCallParams={};var i=this;setTimeout((function(){i.html5Client.startVideoCall(t)}),0)}this.performerToPrivateFromMessages===r.getState().performer.nick&&(r.dispatch(l(this.performerToPrivateFromMessages)),this.performerToPrivateFromMessages=null)},toggleKeyboardActionsOnApplet:function(e,t){if(e.scope&&e.scope.name!==a.ChatModalComponent.NAME&&!1===this.model.getIsMinimized())try{t?this.html5Client.enableKeyboard():this.html5Client.disableKeyboard()}catch(e){}},bind:function(){d.superclass.bind.call(this),s.on([{element:s.Broadcaster,event:a.ModalComponent.GLOBALEVENT_MODAL_OPENED,handler:this.onModalOpened},{element:s.Broadcaster,event:a.ModalComponent.GLOBALEVENT_MODAL_CLOSED,handler:this.onModalClosed},{element:s.Broadcaster,event:a.PerformerView.EVENT_JOIN_VIP_SHOW_FROM_LIST_PAGE,handler:this.onJoinVipShowFromListPageClick},{element:s.Broadcaster,event:"PerformerView:privatePeekButtonClick",handler:this.onPrivatePeekButtonClick},{element:s.Broadcaster,event:"PerformerView:videoCallButtonClick",handler:this.onVideoCallButtonClick},{element:s.Broadcaster,event:a.ModelMessagesConversationController.GLOBALEVENT_VIDEO_CALL_START,handler:this.onStartVideoCallFromMessenger},{element:s.Broadcaster,event:a.FlashExternal.GLOBALEVENT_APPLET_STREAM_READY,handler:this.onStreamReady}],this)}})},b441:function(e,t,i){var s=i("3414"),a=i("d869"),n=function(e){n.superclass.constructor.call(this,e)};e.exports=Ext.extend(n,s.View,{name:"FlashChatPageViewAbstract",windowResizeDebounceTime:300,mainContainerId:"chatblock",footerTopLinkSel:".footer_link",headerTopLinkClass:"header_top_link",chatAppletId:"chatapplet",headerId:"header",footerId:"footer",freechatId:"freechat",_memberAppletEl:null,_mainContainerEl:null,showHTMLClass:"show-html",showFlashClass:"show-flash",init:function(){this.addEvents(a.FlashChatPageViewAbstract.EVENT_WINDOW_RESIZE,a.FlashChatPageViewAbstract.EVENT_APPLET_MINIMIZE),this._selectElements(),n.superclass.init.call(this)},_selectElements:function(){this._freechatEl=Ext.get(this.freechatId),this._mainContainerEl=Ext.get(this.mainContainerId)},minimizeMemberApplet:function(){},setFreeChatBlock:function(){this._freechatEl.display("block")},_showChatBlock:function(){switch(Ext.getBody().addClass("chat-opened"),this._mainContainerEl.removeClass("hidden"),this.name){case"HTML5ChatPageModalView":this._mainContainerEl.removeClass(this.showFlashClass);break;case"FlashChatPageModalView":this._mainContainerEl.removeClass(this.showHTMLClass)}},createMemberAppletContainer:function(){this._freechatEl.createChild('<div id="'+this.chatAppletId+'"></div>'),this._freechatEl.display("block")},getAppletEl:function(){return this._memberAppletEl||(this._memberAppletEl=Ext.get(this.chatAppletId)),this._memberAppletEl},onAppletSizeChange:function(){this.getAppletEl(),this._memberAppletEl.dom.width="",this._memberAppletEl.dom.height=this.model.getAppletSize().height,this.element.setStyle({width:"",height:this.model.getAppletSize().height+"px"}),this._memberAppletEl.dom.removeAttribute("style")},minimizeApplet:function(){this.element.setStyle({width:"1px",height:"1px"}),this.fireEvent(a.FlashChatPageViewAbstract.EVENT_APPLET_MINIMIZE,this)},resetAppletSize:function(){this.element.setStyle({width:"",height:""}),this.getAppletEl().dom.removeAttribute("style")},onWindowResize:function(){this.fireEvent(a.FlashChatPageViewAbstract.EVENT_WINDOW_RESIZE,{scope:this})},removeMemberApplet:function(){this.getAppletEl().remove(),this._memberAppletEl=null},onLayoutModeChange:function(){this.model.isCurrentLayoutMode(a.FlashChatPageControllerAbstract.LAYOUT_MODE_NORMAL)||this.model.isCurrentLayoutMode(a.FlashChatPageControllerAbstract.LAYOUT_MODE_FULLSCREEN)?this._mainContainerEl.removeClass(a.FlashChatPageControllerAbstract.LAYOUT_MODE_FULL):this._mainContainerEl.addClass(a.FlashChatPageControllerAbstract.LAYOUT_MODE_FULL)},updateScrollPosition:function(e){var t=window.scrollX||window.pageXOffset||document.documentElement.scrollLeft,i=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;window.scrollTo(t,i+e)},bind:function(){n.superclass.bind.call(this),s.on([{element:Ext.fly(window),event:"resize",handler:s.debounce(this.onWindowResize,this.windowResizeDebounceTime)},{element:this.model,event:a.ChatPageModel.EVENT_LAYOUT_MODE_CHANGE,handler:this.onLayoutModeChange},{element:this.model,event:a.ChatPageModel.EVENT_APPLET_SIZE_CHANGE,handler:this.onAppletSizeChange}],this)}})},ddd5:function(e,t,i){"use strict";i.r(t);var s=i("a937"),a=i.n(s),n=i("d869"),o=i.n(n),r=i("5aa8"),l=i.n(r),h=i("b441"),c=i.n(h),d=function e(t){e.superclass.constructor.call(this,t)};Ext.extend(d,c.a,{name:"HTML5ChatPageModalView",showClass:"show-html",fullClass:"full",updateScrollPosition:function(e){this._mainContainerEl.dom.scrollTop+=e},_showChatBlock:function(){Ext.getBody().addClass("chat-opened"),d.superclass._showChatBlock.call(this),this._mainContainerEl.addClass(this.showClass)},_hideChatBlock:function(){Ext.getBody().removeClass("chat-opened"),this._mainContainerEl.removeClass(this.showClass),this.getAppletEl()&&this.getAppletEl().blur()},showChat:function(){this.getAppletEl()&&this.getAppletEl().focus()},hideChat:function(){this._resetFreechatElement(),this.minimizeMemberApplet(),this._hideChatBlock()},setAppletSizeType:function(e){e&&(this.element.data("size-type",e),e===o.a.HTML5ChatPageComponent.SIZE_FLUID?this.element.addClass("full"):this.element.removeClass("full"))},_resetFreechatElement:function(){this._freechatEl.dom.removeAttribute("style")},lockChat:function(){this._hideChatBlock()},unlockChat:function(){this._showChatBlock()},hideHTML5Applet:function(){l.a.isWin7IE11()?Ext.fly("member_client_container").addClass("minified"):Ext.fly("member_client_container").addClass("hidden")},showHTML5Applet:function(){l.a.isWin7IE11()?Ext.fly("member_client_container").removeClass("minified"):Ext.fly("member_client_container").removeClass("hidden")}});var p=d;function m(e,t,i,s,a,n,o){try{var r=e[n](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(s,a)}var u;t.default=(u=null,{getComponent:function(e){return(t=regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(i.bind(null,"f94d"));case 2:return s=t.sent,t.next=5,i.e(8).then(i.bind(null,"71fb"));case 5:return n=t.sent,t.abrupt("return",new Promise((function(t){s.default.instance.appletReady.then((function(){u||(u=new n.default("chatblock",{controllerClassName:a.a,viewClassName:p,performerName:e})),t(u)}))})));case 7:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(s,a){var n=t.apply(e,i);function o(e){m(n,s,a,o,r,"next",e)}function r(e){m(n,s,a,o,r,"throw",e)}o(void 0)}))})();var t}})}}]);